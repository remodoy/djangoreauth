(function(a){function b(g){if(e[g])return e[g].c;var h=e[g]={I:g,s:!1,c:{}};a[g].call(h.c,h,h.c,b);h.s=!0;return h.c}var e={};b.G=a;b.D=e;b.d=function(a,e,q){b.m(a,e)||Object.defineProperty(a,e,{configurable:!1,enumerable:!0,get:q})};b.n=function(a){var e=a&&a.B?function(){return a["default"]}:function(){return a};b.d(e,"a",e);return e};b.m=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.F="";return b(b.H=1)})([function(a,b,e){function g(a,c,b){if(!a.hasOwnProperty(c))throw new TypeError("Invalid configuration options: "+
b);}function h(a){return a.authEndpoint+"?instance="+encodeURIComponent(a.instance)+"&application="+encodeURIComponent(a.application)+"&origin="+encodeURIComponent(a.applicationOrigin)+(a.predefinedFlow?"&flow="+encodeURIComponent(a.predefinedFlow):"")}Object.defineProperty(b,"__esModule",{value:!0});e.d(b,"tokenKey",function(){return r});e.d(b,"refreshTokenKey",function(){return t});e.d(b,"sessionKey",function(){return v});e.d(b,"isAuthenticated",function(){return x});e.d(b,"configure",function(){return y});
e.d(b,"startAuthentication",function(){return z});e.d(b,"fetchToken",function(){return A});e.d(b,"refreshAuthentication",function(){return B});e.d(b,"signOut",function(){return C});e.d(b,"addEventListener",function(){return D});e.d(b,"removeEventListener",function(){return E});var q=this&&this.A||function(a,c,b,e){return new (b||(b=Promise))(function(d,n){function m(a){try{k(e.next(a))}catch(p){n(p)}}function f(a){try{k(e["throw"](a))}catch(p){n(p)}}function k(a){a.done?d(a.value):(new b(function(d){d(a.value)})).then(m,
f)}k((e=e.apply(a,c||[])).next())})},w=this&&this.C||function(a,b){function c(a){return function(d){return e([a,d])}}function e(c){if(k)throw new TypeError("Generator is already executing.");for(;d;)try{if(k=1,l&&(f=l[c[0]&2?"return":c[0]?"throw":"next"])&&!(f=f.call(l,c[1])).done)return f;if(l=0,f)c=[0,f.value];switch(c[0]){case 0:case 1:f=c;break;case 4:return d.label++,{value:c[1],done:!1};case 5:d.label++;l=c[1];c=[0];continue;case 7:c=d.g.pop();d.h.pop();continue;default:if(!(f=d.h,f=0<f.length&&
f[f.length-1])&&(6===c[0]||2===c[0])){d=0;continue}if(3===c[0]&&(!f||c[1]>f[0]&&c[1]<f[3]))d.label=c[1];else if(6===c[0]&&d.label<f[1])d.label=f[1],f=c;else if(f&&d.label<f[2])d.label=f[2],d.g.push(c);else{f[2]&&d.g.pop();d.h.pop();continue}}c=b.call(a,d)}catch(p){c=[6,p],l=0}finally{k=f=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var d={label:0,j:function(){if(f[0]&1)throw f[1];return f[1]},h:[],g:[]},k,l,f,u;return u={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&
(u[Symbol.iterator]=function(){return this}),u},r="reauthToken",t="reauthRefreshToken",v="reauthSession",F={K:!1,J:!1};a=new (function(){function a(){this.options={};this.b={};try{var a=void 0;if(a=window.localStorage.getItem(v))this.a=JSON.parse(a),this.dispatchEvent("sessionChanged",this.a)}catch(m){console.error("Failed to deserialize stored session: "+m.message)}}a.prototype.f=function(){return!!this.a&&!!window.localStorage.getItem(r)&&!!window.localStorage.getItem(t)};a.prototype.o=function(a){return q(this,
void 0,void 0,function(){var c,b;return w(this,function(d){switch(d.label){case 0:this.options=Object.assign(F,this.options,a);g(this.options,"authEndpoint","Authentication endpoint not defined");g(this.options,"instance","Target instance not defined");g(this.options,"application","Application not defined");this.options.applicationOrigin=this.options.useRedirect?window.location.href:window.location.origin;c=this.options.allowedResponseOrigins||[];this.options.allowedResponseOrigins=c.concat([this.options.authEndpoint]);
if(this.f())return this.dispatchEvent("authenticated",this.a),[2];if(d=this.options.useRedirect){a:{d=window.location.search.split("&");0<d.length&&(d[0]=d[0].substring(1));for(var e=0;e<d.length;e++){var n=d[e];if(n.startsWith("code")){d=n.split("=")[1];break a}}d=void 0}d=b=d}return d?[4,this.i(b)]:[3,2];case 1:d.j(),this.dispatchEvent("authenticated",this.a),d.label=2;case 2:return[2]}})})};a.prototype.w=function(){var a=this;return new Promise(function(c,b){if(a.f())b(Error("Already authenticated"));
else if(b=h(a.options),a.options.useRedirect)window.location.href=b,c();else{console.log("lers");var d=window.open(b,"reauthlogin","width=640,height=720,menubar=0,toolbar=0,location=0,personalbar=0,status=0,scrollbars=0"),e=function(c){console.log("ev",c);if(a.options.allowedResponseOrigins.includes(c.origin)){if(c.source!==d)throw Error("Unauthorized message received");window.removeEventListener("message",e,!1);a.l(c.data);a.dispatchEvent("authenticated",a.a)}else console.warn("Mismatched origins",
c.origin,"ignoring")};window.addEventListener("message",e,!1)}})};a.prototype.i=function(a){return q(this,void 0,void 0,function(){var c,b;return w(this,function(d){switch(d.label){case 0:return c=this.options.authEndpoint+"/api/v1/token/"+a+"/",[4,fetch(c,{mode:"cors"}).then(function(a){return a.json()}).then(function(a){return a.jwtToken})];case 1:return b=d.j(),this.l(b),[2,b]}})})};a.prototype.u=function(){throw Error("Not implemented yet");};a.prototype.v=function(){this.a={};window.localStorage.removeItem(r);
window.localStorage.removeItem(t)};a.prototype.l=function(a){this.a||(this.a={});window.localStorage.setItem(r,a);window.localStorage.setItem(t,void 0);try{this.a=JSON.parse(atob(decodeURIComponent(a.split(".")[1]))),window.localStorage.setItem(v,JSON.stringify(this.a))}catch(m){console.error("Failed to deserialize and store profile from token: "+m.message)}this.dispatchEvent("sessionChanged",this.a);this.options.storeInCookie&&(document.cookie="reauthBearer="+a+";domain="+window.location.hostname+
";secure;HttpOnly");this.dispatchEvent("token",a)};a.prototype.addEventListener=function(a,b){this.b[a]||(this.b[a]=[]);this.b[a].push(b)};a.prototype.removeEventListener=function(a,b){if(a in this.b){a=this.b[a];for(var c=0,d=a.length;c<d;c++)if(a[c]===b){a.splice(c,1);break}}};a.prototype.dispatchEvent=function(a,b){if(a in this.b){a=this.b[a];for(var c=0,d=a.length;c<d;c++)a[c].call(this,b)}};return a}());var x=a.f.bind(a),y=a.o.bind(a),z=a.w.bind(a),A=a.i.bind(a),B=a.u.bind(a),C=a.v.bind(a),D=
a.addEventListener.bind(a),E=a.removeEventListener.bind(a)},function(a,b,e){Object.defineProperty(b,"__esModule",{value:!0});a=e(2);e.n(a)},function(a,b,e){b=e(3);a.c=b.ReAuth=e(0)},function(a){var b=function(){return this}();try{b=b||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(b=window)}a.c=b}]);
